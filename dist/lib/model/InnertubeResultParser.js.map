{"version":3,"file":"InnertubeResultParser.js","sourceRoot":"","sources":["../../../src/lib/model/InnertubeResultParser.ts"],"names":[],"mappings":"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","sourcesContent":["import { IBrowseResponse, INextResponse, ISearchResponse, YTNodes, Misc as YTMisc, Utils as YTUtils, Helpers as YTHelpers } from 'volumio-youtubei.js';\nimport Endpoint, { EndpointType } from '../types/Endpoint';\nimport WatchContent, { WatchContinuationContent } from '../types/WatchContent';\nimport PageContent from '../types/PageContent';\nimport { ContentItem, PageElement } from '../types';\nimport { Continuation, SectionItem } from '../types/PageElement';\n\ntype ParseableInnertubeResponse = INextResponse | ISearchResponse | IBrowseResponse;\n\ntype NestedSection = YTNodes.SectionList &\n                     YTNodes.ItemSection &\n                     YTNodes.Shelf &\n                     YTNodes.ReelShelf &\n                     YTNodes.ExpandedShelfContents &\n                     YTNodes.HorizontalList &\n                     YTNodes.Grid &\n                     YTNodes.PlaylistVideoList &\n                     YTNodes.RichSection &\n                     YTNodes.RichShelf &\n                     YTNodes.HorizontalCardList &\n                     YTNodes.HorizontalMovieList &\n                     YTNodes.VerticalList &\n                     YTNodes.GuideSection &\n                     YTNodes.GuideSubscriptionsSection;\n\ntype SectionContent = NestedSection |\n                      (NestedSection &\n                      YTNodes.Tab &\n                      YTNodes.ReelShelf &\n                      YTNodes.ExpandedShelfContents &\n                      YTNodes.RichShelf) &\n                      { content?: any };\n\nexport default class InnertubeResultParser {\n\n  static parseResult(data: ParseableInnertubeResponse | { contents: any },\n    originatingEndpointType?: EndpointType.Browse | EndpointType.BrowseContinuation | EndpointType.Search | EndpointType.SearchContinuation) : PageContent | null;\n  static parseResult(data: ParseableInnertubeResponse | { contents: any },\n    originatingEndpointType: EndpointType.Watch ) : WatchContent | null;\n  static parseResult(data: ParseableInnertubeResponse | { contents: any },\n    originatingEndpointType: EndpointType.WatchContinuation ) : WatchContinuationContent | null;\n  static parseResult(data: ParseableInnertubeResponse | { contents: any },\n    originatingEndpointType?: EndpointType): PageContent | WatchContent | WatchContinuationContent | null;\n  static parseResult(data: ParseableInnertubeResponse | { contents: any },\n    originatingEndpointType?: EndpointType) {\n\n    switch (originatingEndpointType) {\n      case EndpointType.Watch:\n        return this.#parseWatchEndpointResult(data as INextResponse);\n\n      case EndpointType.WatchContinuation:\n        return this.#parseWatchContinuationEndpointResult(data as INextResponse);\n\n      case EndpointType.Search:\n        return this.#parseSearchEndpointResult(data as ISearchResponse);\n\n      // Browse / BrowseContinuation / SearchContinuation\n      default:\n        return this.#parseBrowseEndpointResult(data as IBrowseResponse);\n    }\n  }\n\n  static #parseWatchContinuationEndpointResult(data: INextResponse): WatchContinuationContent | null {\n    const itemContinuations = data.on_response_received_endpoints || null;\n\n    if (itemContinuations && itemContinuations.length > 0) {\n      const actions = itemContinuations.filter((c) =>\n        c.type === 'appendContinuationItemsAction');\n      if (actions) {\n        const acItems = actions.reduce<YTHelpers.YTNode[]>((result, ac) => {\n          if (ac.contents) {\n            result.push(...ac.contents);\n          }\n          return result;\n        }, []);\n        const parsedItems = acItems.reduce<WatchContinuationContent['items']>((result, item) => {\n          const parsedItem = this.#parseContentItem(item);\n          if (parsedItem && (parsedItem.type === 'video' || parsedItem.type === 'playlist')) {\n            result.push(parsedItem);\n          }\n          return result;\n        }, []);\n        const watchContinuationContent: WatchContinuationContent = {\n          type: 'watch',\n          isContinuation: true,\n          items: parsedItems\n        };\n        const continuationItem = acItems.find((item) => item.type === 'ContinuationItem') as YTNodes.ContinuationItem;\n        const parsedContinuation = this.#parseContinuationItem(continuationItem);\n        if (parsedContinuation && parsedContinuation.endpoint.type === EndpointType.WatchContinuation) {\n          watchContinuationContent.continuation = parsedContinuation as Continuation<typeof parsedContinuation.endpoint.type>;\n        }\n\n        return watchContinuationContent;\n      }\n    }\n\n    return null;\n  }\n\n  static #parseWatchEndpointResult(data: INextResponse): WatchContent | null {\n    const dataContents = this.unwrap(data.contents);\n    if (!dataContents) {\n      return null;\n    }\n\n    const result: WatchContent = { type: 'watch', isContinuation: false };\n\n    if (!Array.isArray(dataContents) && dataContents.type === 'TwoColumnWatchNextResults') {\n      const twoColumnWatchNextResults = dataContents as YTNodes.TwoColumnWatchNextResults;\n\n      // Playlist items\n      const playlistData = twoColumnWatchNextResults.playlist;\n      if (playlistData) {\n        const playlistItems = playlistData.contents.reduce<ContentItem.Video[]>((items, itemData) => {\n          const parsedItem = this.#parseContentItem(itemData);\n          if (parsedItem && parsedItem.type === 'video') {\n            items.push(parsedItem);\n          }\n          return items;\n        }, []);\n        result.playlist = {\n          type: 'playlist',\n          playlistId: playlistData.id,\n          title: playlistData.title,\n          items: playlistItems,\n          currentIndex: playlistData.current_index\n        };\n        const playlistAuthor = this.#parseAuthor(playlistData.author);\n        if (playlistAuthor) {\n          result.playlist.author = playlistAuthor;\n        }\n      }\n\n      // Autoplay item\n      const autoplayEndpoint = this.parseEndpoint(twoColumnWatchNextResults.autoplay?.sets[0].autoplay_video);\n      if (autoplayEndpoint) {\n        result.autoplay = autoplayEndpoint;\n      }\n\n      // Related\n      // - If user is signed out, related items appear directly under secondary_results\n      // - If user is signed in, related items appear in ItemSection under secondary_results\n      const itemSection = twoColumnWatchNextResults.secondary_results.firstOfType(YTNodes.ItemSection);\n      const relatedItemList = itemSection ? itemSection.contents : twoColumnWatchNextResults.secondary_results;\n      if (relatedItemList) {\n        const parsedItems = relatedItemList.map((item) => this.#parseContentItem(item));\n        result.related = {\n          items: parsedItems.filter((item) => item?.type === 'video' || item?.type === 'playlist') as (ContentItem.Video | ContentItem.Playlist)[]\n        };\n        const continuationItem = relatedItemList.find((item) => item.type === 'ContinuationItem') as YTNodes.ContinuationItem;\n        const parsedContinuation = this.#parseContinuationItem(continuationItem);\n        if (parsedContinuation && parsedContinuation.endpoint.type === EndpointType.WatchContinuation) {\n          result.related.continuation = parsedContinuation as Continuation<typeof parsedContinuation.endpoint.type>;\n        }\n      }\n\n      return result;\n    }\n\n    return null;\n  }\n\n  static #parseSearchEndpointResult(data: ISearchResponse): PageContent | null {\n    const dataContents = this.unwrap(data.contents);\n    if (!dataContents) {\n      return null;\n    }\n\n    if (!Array.isArray(dataContents) && dataContents.type === 'TwoColumnSearchResults') {\n      const twoColumnSearchResults = dataContents as YTNodes.TwoColumnSearchResults;\n      return this.#parseBrowseEndpointResult({ contents: twoColumnSearchResults.primary_contents });\n    }\n\n    return null;\n  }\n\n  static #parseBrowseEndpointResult(data: Partial<IBrowseResponse & ISearchResponse>): PageContent | null {\n\n    const itemContinuations = data.on_response_received_actions ||\n          data.on_response_received_endpoints ||\n          data.on_response_received_commands || null;\n\n    if (itemContinuations && itemContinuations.length > 0) {\n      const actionOrCommands = itemContinuations.filter((c) =>\n        c.type === 'appendContinuationItemsAction' ||\n        c.type === 'reloadContinuationItemsCommand');\n      if (actionOrCommands) {\n        const sections = actionOrCommands.reduce<PageElement.Section[]>((sections, ac) => {\n          const parsedSection = this.#parseContentToSection({ content: this.unwrap(ac.contents) } as SectionContent);\n          if (parsedSection) {\n            sections.push(parsedSection);\n          }\n          return sections;\n        }, []);\n        if (sections) {\n          return {\n            type: 'page',\n            isContinuation: true,\n            sections\n          };\n        }\n        return null;\n      }\n    }\n\n    const result: PageContent = {\n      type: 'page',\n      isContinuation: false,\n      sections: []\n    };\n\n    if (data.header) {\n      const dataHeader = this.unwrap(data.header);\n      if (dataHeader && !Array.isArray(dataHeader)) {\n        const header = this.#parseHeader(dataHeader);\n        if (header) {\n          result.header = header;\n        }\n      }\n    }\n\n    const dataContents = this.unwrap(data.contents);\n\n    if (dataContents && !Array.isArray(dataContents) && dataContents.hasKey('tabs')) {\n      const tabs = this.unwrap(dataContents.tabs);\n      if (tabs && Array.isArray(tabs)) {\n        const reducedTabs = tabs.filter((tab) => tab.type !== 'ExpandableTab')\n          .reduce((filtered, tab) => {\n            const parseEndpoint = this.parseEndpoint(tab.endpoint);\n            const tabTitle = this.unwrap(tab.title);\n            if (parseEndpoint && tabTitle) {\n              filtered.push({\n                text: tabTitle,\n                endpoint: parseEndpoint,\n                selected: !!tab.selected\n              });\n            }\n            return filtered;\n          }, []);\n\n        if (reducedTabs.length > 0) {\n          result.tabs = reducedTabs;\n        }\n\n        const selectedTab = tabs.find((tab) => tab.selected);\n        if (selectedTab) {\n          const parsedSection = this.#parseContentToSection(selectedTab.content);\n          if (parsedSection) {\n            result.sections.push(parsedSection);\n          }\n        }\n      }\n    }\n    else {\n      const parsedSection = this.#parseContentToSection({ content: dataContents } as SectionContent);\n      if (parsedSection) {\n        result.sections.push(parsedSection);\n      }\n    }\n\n    return result;\n  }\n\n  static #parseHeader(data: YTHelpers.YTNode): PageElement.Header | PageElement.PlaylistHeader | null {\n    if (!data) {\n      return null;\n    }\n\n    let type: PageElement.Header['type'] | null = null,\n      title: string | null = null,\n      subtitles: string[] = [],\n      description: string| null = null,\n      thumbnail: string | null = null,\n      endpoint: Endpoint | null = null,\n      author: ContentItem.Author | null = null,\n      shufflePlay: ContentItem.EndpointLink | null = null;\n\n    if (data.type === 'FeedTabbedHeader') {\n      type = 'feed';\n      const fthData = data as YTNodes.FeedTabbedHeader;\n      title = this.unwrap(fthData.title);\n    }\n    // Channel\n    else if (data.type === 'C4TabbedHeader') {\n      type = 'channel';\n      const c4thData = data as YTNodes.C4TabbedHeader;\n      title = this.unwrap(c4thData.author?.name);\n      thumbnail = this.parseThumbnail(c4thData.author?.thumbnails);\n\n      if (c4thData.subscribers) {\n        const subscribers = this.unwrap(c4thData.subscribers);\n        if (subscribers) {\n          subtitles.push(subscribers);\n        }\n      }\n      if (c4thData.videos_count) {\n        const videosCount = this.unwrap(c4thData.videos_count);\n        if (videosCount) {\n          subtitles.push(videosCount);\n        }\n      }\n\n      endpoint = this.parseEndpoint(c4thData.author?.endpoint);\n    }\n    // E.g. Gaming channel\n    else if (data.type === 'InteractiveTabbedHeader') {\n      type = 'channel';\n      const ithData = data as YTNodes.InteractiveTabbedHeader;\n      title = this.unwrap(ithData.title);\n      thumbnail = this.parseThumbnail(ithData.box_art);\n      const ithMetadata = this.unwrap(ithData.metadata);\n      if (ithMetadata) {\n        subtitles.push(ithMetadata);\n      }\n      description = this.unwrap(ithData.description);\n    }\n    // Playlist\n    else if (data.type === 'PlaylistHeader') {\n      type = 'playlist';\n      const plData = data as YTNodes.PlaylistHeader;\n      title = this.unwrap(plData.title);\n      if (plData.stats) {\n        subtitles = plData.stats.map((stat) => this.unwrap(stat));\n      }\n      const plVideoCount = this.unwrap(plData.num_videos);\n      if (plVideoCount) {\n        subtitles.push(plVideoCount);\n      }\n      description = this.unwrap(plData.description);\n      if (plData.banner?.hasKey('thumbnails')) {\n        thumbnail = this.parseThumbnail(plData.banner.thumbnails);\n      }\n      if (plData.banner?.hasKey('on_tap_endpoint')) {\n        endpoint = this.parseEndpoint(plData.banner.on_tap_endpoint); // Watch endpoint\n      }\n      author = this.#parseAuthor(plData.author);\n      const shufflePlayButton = this.unwrap(plData.shuffle_play_button);\n      if (shufflePlayButton && !Array.isArray(shufflePlayButton) && shufflePlayButton.hasKey('endpoint') && shufflePlayButton.hasKey('text')) {\n        const shufflePlayEndpoint = this.parseEndpoint(shufflePlayButton?.endpoint);\n        if (shufflePlayEndpoint) {\n          shufflePlay = {\n            type: 'endpointLink',\n            title: this.unwrap(shufflePlayButton.text),\n            endpoint: shufflePlayEndpoint\n          };\n        }\n      }\n    }\n    // Topic\n    else if (data.type === 'CarouselHeader') {\n      const chData = data as YTNodes.CarouselHeader;\n      const details = chData.contents.find((header) => header.type === 'TopicChannelDetails');\n      if (details) {\n        const tcdData = details as YTNodes.TopicChannelDetails;\n        type = 'channel';\n        title = this.unwrap(tcdData.title);\n        thumbnail = this.parseThumbnail(tcdData.avatar);\n        endpoint = this.parseEndpoint(tcdData.endpoint);\n\n        const detailsSubtitle = this.unwrap(tcdData.subtitle);\n        if (detailsSubtitle) {\n          subtitles.push(detailsSubtitle);\n        }\n      }\n    }\n\n    if (type && title) {\n      const result: PageElement.Header = {\n        type,\n        title\n      };\n\n      if (subtitles.length > 0) {\n        result.subtitles = subtitles;\n      }\n      if (description) {\n        result.description = description;\n      }\n      if (thumbnail) {\n        result.thumbnail = thumbnail;\n      }\n      if (endpoint) {\n        result.endpoint = endpoint;\n      }\n\n      if (type === 'playlist') {\n        if (author) {\n          (result as PageElement.PlaylistHeader).author = author;\n        }\n        if (shufflePlay) {\n          (result as PageElement.PlaylistHeader).shufflePlay = shufflePlay;\n        }\n      }\n\n      return result;\n    }\n\n    return null;\n  }\n\n  /**\n   * Parses header and contents of `data` and returns an object with simplified data structure.\n   * `data` can be from:\n   * - Tab\n   * - SectionList\n   * - ItemSection,\n   * - Shelf\n   * - HorizontalList\n   * - Grid\n   * - PlaylistVideoList\n   * - RichSection\n   * - HorizontalCardList\n   * - HorizontalMovieList\n   * - VerticalList\n   * - GuideSection,\n   * - GuideSubscriptionsSection\n   * Contents of `data` can contain nested sections (e.g. Tab contents can contain\n   * ItemSections which in turn contain Shelfs, as opposed to an array of media items).\n   * When this happens, the function will call itself and add the result with type `section` to the `items` array.\n   * @param {*} data\n   * @returns Object with simplified data structure, or `null` if the resulting structure is empty.\n   */\n  static #parseContentToSection(data?: SectionContent | null): PageElement.Section | null {\n    if (!data) {\n      return null;\n    }\n\n    const nestedSectionTypes = [\n      'SectionList',\n      'ItemSection',\n      'Shelf',\n      'ReelShelf',\n      'ExpandedShelfContents',\n      'HorizontalList',\n      'Grid',\n      'PlaylistVideoList',\n      'RichSection',\n      'RichShelf',\n      'HorizontalCardList',\n      'HorizontalMovieList',\n      'VerticalList',\n      'GuideSection',\n      'GuideSubscriptionsSection'\n    ];\n\n    const section: PageElement.Section = {\n      type: 'section',\n      items: []\n    };\n\n    const __parseContentItem = (contentItem: NestedSection | YTHelpers.YTNode | YTNodes.ContinuationItem) => {\n      if (nestedSectionTypes.includes(contentItem.type)) {\n        // Nested section\n        const parsedNested = this.#parseContentToSection(contentItem as NestedSection);\n        if (parsedNested) {\n          section.items.push(parsedNested);\n        }\n      }\n      else if (contentItem.type === 'ContinuationItem') {\n        const continuationItem = this.#parseContinuationItem(contentItem as YTNodes.ContinuationItem);\n        if (continuationItem && (continuationItem.endpoint.type === EndpointType.BrowseContinuation ||\n          continuationItem.endpoint.type === EndpointType.SearchContinuation)) {\n          section.continuation = continuationItem as Continuation<typeof continuationItem.endpoint.type>;\n        }\n      }\n      else {\n        const mediaItem = this.#parseContentItem(contentItem as YTHelpers.YTNode);\n        if (mediaItem) {\n          section.items.push(mediaItem);\n        }\n      }\n    };\n\n    const dataHeader = data.header;\n    // Property name for contents depend on data. E.g.:\n    // Tab content / ItemSection / RichShelf: contents\n    // Shelf / RichSection: content\n    // HorizontalList / GuideSection / GuideSubscriptionsSection / ExpandedShelfContents / ReelShelf: items\n    // PlaylistVideoList: videos\n    // HorizontalCardList: cards\n\n    const dataContents = this.unwrap(data.contents) || this.unwrap(data.content) ||\n      this.unwrap(data.items) || this.unwrap(data.videos) || this.unwrap(data.cards);\n\n    // Filters\n    const sectionFilters: PageElement.Option[] = [];\n\n    // FeedFilterChipBar\n    if (dataHeader?.type === 'FeedFilterChipBar') {\n      const chips = (dataHeader as unknown as YTNodes.FeedFilterChipBar).contents;\n      /**\n       * Note that, unlike other 'option.optionValues' type arrays, we don't\n       * validate endpoint for FeedFilterChipBar. This is because the selected\n       * chip does actually not provide an endpoint, but we don't want to\n       * exclude it from the filters.\n       */\n      const dataFilters = chips?.filter((chip) => chip.type === 'ChipCloudChip')\n        .map((chip) => {\n          const endpoint = this.parseEndpoint(chip.endpoint);\n          return {\n            text: chip.text,\n            endpoint,\n            selected: !!chip.is_selected\n          };\n        });\n      if (dataFilters.length > 0) {\n        sectionFilters.push({\n          type: 'option',\n          optionValues: dataFilters\n        });\n      }\n    }\n\n    // SectionList.SearchSubMenu\n    if (data.sub_menu?.type === 'SearchSubMenu') {\n      // One filter per group\n      const ssmData = data.sub_menu as YTNodes.SearchSubMenu;\n      const searchFilters = ssmData.groups?.reduce<PageElement.Option[]>((filters, group) => {\n        const title = this.unwrap(group.title);\n        const optionValues = group.filters?.filter((f) => !f.disabled)\n          .reduce<PageElement.Option['optionValues']>((result, f) => {\n            const endpoint = this.parseEndpoint(f.endpoint);\n            if (endpoint) {\n              result.push({\n                text: this.unwrap(f.label),\n                endpoint,\n                selected: !!f.selected\n              });\n            }\n            return result;\n          }, []);\n        if (optionValues && optionValues.length > 0) {\n          filters.push({\n            type: 'option',\n            title,\n            optionValues\n          });\n        }\n        return filters;\n      }, []);\n\n      if (searchFilters && searchFilters?.length > 0) {\n        sectionFilters.push(...searchFilters);\n      }\n    }\n\n    if (sectionFilters.length > 0) {\n      section.filters = sectionFilters;\n    }\n\n    const dataTitle = this.unwrap(data.title || data.header?.title);\n    const dataEndpoint = this.parseEndpoint(data.endpoint);\n    if (dataTitle) {\n      section.title = dataTitle;\n    }\n    if (dataEndpoint) {\n      section.endpoint = dataEndpoint;\n    }\n\n    // Menus\n    const sectionMenus: PageElement.Option[] = [];\n\n    // SectionList.ChannelSubMenu\n    if (data.sub_menu?.type === 'ChannelSubMenu') {\n      const cssData = data.sub_menu as YTNodes.ChannelSubMenu;\n      const contentTypeMenu: PageElement.Option = {\n        type: 'option',\n        optionValues: cssData.content_type_sub_menu_items.reduce<PageElement.Option['optionValues']>(\n          (result, item) => {\n            const endpoint = this.parseEndpoint(item.endpoint);\n            if (endpoint) {\n              result.push({\n                text: item.title,\n                endpoint,\n                selected: !!item.selected\n              });\n            }\n            return result;\n          }, [])\n      };\n\n      // If menu only has one option, set that as section title instead (if not not already set)\n      if (contentTypeMenu.optionValues.length > 1) {\n        sectionMenus.push(contentTypeMenu);\n      }\n      else if (!section.title) {\n        section.title = contentTypeMenu.optionValues[0]?.text;\n      }\n\n      const sortSetting = cssData.sort_setting as YTNodes.SortFilterSubMenu; // SortFilterSubMenu\n      if (sortSetting && sortSetting.sub_menu_items) {\n        const sortFilterMenu: PageElement.Option = {\n          type: 'option',\n          title: sortSetting.title,\n          optionValues: sortSetting.sub_menu_items.reduce<PageElement.Option['optionValues']>(\n            (result, item) => {\n              const endpoint = this.parseEndpoint(item.endpoint);\n              if (endpoint) {\n                result.push({\n                  text: item.title,\n                  endpoint,\n                  selected: !!item.selected\n                });\n              }\n              return result;\n            }, [])\n        };\n        sectionMenus.push(sortFilterMenu);\n      }\n    }\n\n    if (sectionMenus.length > 0) {\n      section.menus = sectionMenus;\n    }\n\n    // Buttons\n    const sectionButtons: PageElement.Button[] = [];\n\n    let topLevelButtons: any = null;\n    if (data.menu?.hasKey('top_level_buttons')) {\n      topLevelButtons = data.menu.top_level_buttons;\n    }\n    if (Array.isArray(topLevelButtons)) { // E.g. 'See All' button in Library\n      for (const button of topLevelButtons.filter((button) => !button.is_disabled)) {\n        const parsedButton = this.#parseButton(button);\n        if (parsedButton) {\n          sectionButtons.push(parsedButton);\n        }\n      }\n    }\n\n    // PlayAllButton (e.g. in Channel -> Shelf)\n    if (data.play_all_button) {\n      const parsedButton = this.#parseButton(data.play_all_button);\n      if (parsedButton) {\n        sectionButtons.push(parsedButton);\n      }\n    }\n\n    if (sectionButtons.length > 0) {\n      section.buttons = sectionButtons;\n    }\n\n    // TODO: `Shelf` has `sortFilter` not parsed by YouTube.js.\n    // Seems to appear only in Library -> Playlists section. Should we\n    // Include it?\n\n    if (dataContents) {\n      if (Array.isArray(dataContents)) {\n        for (const contentItem of dataContents) {\n          __parseContentItem(contentItem);\n        }\n      }\n      else {\n        __parseContentItem(dataContents);\n      }\n    }\n\n    const hasFilters = section.filters && section.filters.length > 0;\n    const hasMenus = section.menus && section.menus.length > 0;\n    const hasButtons = section.buttons && section.buttons.length > 0;\n\n    if (section.items.length > 0 || hasFilters || hasMenus ||\n      hasButtons || section.title || section.continuation) {\n      return section;\n    }\n\n    return null;\n  }\n\n  static #parseContentItem(data?: YTHelpers.YTNode | null): SectionItem | null {\n    if (!data) {\n      return null;\n    }\n\n    switch (data.type) {\n      case 'Video':\n      case 'CompactVideo':\n      case 'VideoCard':\n      case 'GridVideo':\n      case 'PlaylistVideo':\n      case 'ReelItem': // Published / author / duration  will be null\n      case 'PlaylistPanelVideo': // Published / viewCount will be null\n      case 'GridMovie': // Published / viewCount will be null\n        const vData = data as YTNodes.Video &\n                              YTNodes.CompactVideo &\n                              YTNodes.VideoCard &\n                              YTNodes.GridVideo &\n                              YTNodes.PlaylistVideo &\n                              YTNodes.ReelItem &\n                              YTNodes.PlaylistPanelVideo &\n                              YTNodes.GridMovie;\n        return {\n          type: 'video',\n          videoId: vData.id || vData.video_id,\n          title: this.unwrap(vData.title),\n          author: this.#parseAuthor(vData.author),\n          thumbnail: this.parseThumbnail(vData.thumbnails || vData.thumbnail) || null,\n          viewCount: this.unwrap(vData.view_count) || this.unwrap(vData.views),\n          published: this.unwrap(vData.published),\n          duration: this.#parseDuration(vData.duration),\n          endpoint: this.parseEndpoint(vData.endpoint)\n        } as ContentItem.Video;\n\n      case 'CompactStation': // Masquerade as playlist\n        const csData = data as YTNodes.CompactStation;\n        return {\n          type: 'playlist',\n          title: this.unwrap(csData.title),\n          thumbnail: this.parseThumbnail(csData.thumbnail),\n          videoCount: this.unwrap(csData.video_count),\n          endpoint: this.parseEndpoint(csData.endpoint) // Watch endpoint\n        } as ContentItem.Playlist;\n\n      case 'GameCard':\n        const gcData = data as YTNodes.GameCard;\n        const gameData = gcData.game.type === 'GameDetails' ? gcData.game as YTNodes.GameDetails : null;\n        if (gameData) {\n          return {\n            type: 'channel',\n            name: this.unwrap(gameData.title),\n            channelId: gameData.endpoint.payload.browseId,\n            thumbnail: this.parseThumbnail(gameData.box_art) || null,\n            endpoint: this.parseEndpoint(gameData.endpoint)\n          } as ContentItem.Channel;\n        }\n        return null;\n\n      case 'Playlist':\n      case 'GridPlaylist':\n      case 'Mix':\n      case 'GridMix':\n      case 'CompactMix':\n        const plData = data as YTNodes.Playlist &\n                               YTNodes.GridPlaylist &\n                               YTNodes.Mix &\n                               YTNodes.GridMix &\n                               YTNodes.CompactMix;\n        const playlistItem = {\n          type: 'playlist',\n          playlistId: plData.id,\n          title: this.unwrap(plData.title),\n          thumbnail: this.parseThumbnail(plData.thumbnails) || null,\n          author: this.#parseAuthor(plData.author),\n          videoCount: this.unwrap(plData.video_count),\n          endpoint: this.parseEndpoint(plData.endpoint), // Watch endpoint\n          isMix: data.type.includes('Mix')\n        } as ContentItem.Playlist;\n\n        const plBrowseEndpoint = this.parseEndpoint(plData.view_playlist?.endpoint);\n        if (plBrowseEndpoint) { // Browse endpoint for GridPlaylist\n          playlistItem.browseEndpoint = plBrowseEndpoint;\n        }\n\n        return playlistItem;\n\n      case 'Channel':\n      case 'GridChannel':\n        const chData = data as YTNodes.Channel & YTNodes.GridChannel;\n        const dataAuthor = this.#parseAuthor(chData.author);\n        if (dataAuthor) {\n          const result = {\n            type: 'channel',\n            channelId: chData.id,\n            name: dataAuthor.name,\n            thumbnail: dataAuthor.thumbnail,\n            subscribers: this.unwrap(chData.subscribers),\n            endpoint: this.parseEndpoint(chData.endpoint)\n          } as ContentItem.Channel;\n\n          return result;\n        }\n        return null;\n\n      case 'GuideEntry':\n        const geData = data as YTNodes.GuideEntry;\n        return {\n          type: 'guideEntry',\n          title: this.unwrap(geData.title),\n          thumbnail: this.parseThumbnail(geData.thumbnails),\n          icon: geData.icon_type,\n          endpoint: this.parseEndpoint(geData.endpoint),\n          isPrimary: geData.is_primary\n        } as ContentItem.GuideEntry;\n\n      case 'RichItem':\n        const riData = data as YTNodes.RichItem;\n        return this.#parseContentItem(riData.content);\n\n      case 'ShowingResultsFor':\n        const srfData = data as YTNodes.ShowingResultsFor;\n        const showResultsForText = `${this.unwrap(srfData.showing_results_for)} ${this.unwrap(srfData.corrected_query)\n        }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${this.unwrap(srfData.search_instead_for)} ${this.unwrap(srfData.original_query)}`;\n        return {\n          type: 'endpointLink',\n          title: showResultsForText,\n          icon: 'YT2_SHOWING_RESULTS_FOR', // Our own icon type to be used as a hint of what this endpoint is about\n          endpoint: this.parseEndpoint(srfData.original_query_endpoint)\n        } as ContentItem.EndpointLink;\n\n      default:\n        return null;\n    }\n  }\n\n  static #parseAuthor(data: YTMisc.Text | YTMisc.Author): ContentItem.Author | null {\n    if (!data) {\n      return null;\n    }\n\n    if (typeof data === 'string' || data instanceof YTMisc.Text) {\n      return {\n        name: this.unwrap(data)\n      };\n    }\n\n    return {\n      channelId: data.id,\n      name: this.unwrap(data.name),\n      thumbnail: this.parseThumbnail(data.thumbnails),\n      endpoint: this.parseEndpoint(data.endpoint)\n    };\n  }\n\n  static #parseDuration(data?: YTMisc.Text | string | { seconds: number }): number | null {\n    if (!data) {\n      return null;\n    }\n\n    if (data instanceof YTMisc.Text) {\n      const s = this.unwrap(data);\n      if (s) {\n        return YTUtils.timeToSeconds(s);\n      }\n    }\n    else if (typeof data === 'object' && data.seconds) {\n      return data.seconds;\n    }\n\n    if (typeof data === 'string') {\n      return YTUtils.timeToSeconds(data);\n    }\n\n    return null;\n  }\n\n  static #parseContinuationItem(data: YTNodes.ContinuationItem) {\n    if (!data) {\n      return null;\n    }\n    const endpoint = this.parseEndpoint(data.endpoint);\n    if (!endpoint || (endpoint.type !== EndpointType.BrowseContinuation &&\n      endpoint.type !== EndpointType.SearchContinuation && endpoint.type !== EndpointType.WatchContinuation)) {\n      return null;\n    }\n\n    const result: PageElement.Continuation<typeof endpoint.type> = {\n      type: 'continuation',\n      endpoint: { ...endpoint, type: endpoint.type }\n    };\n\n    if (data.button?.hasKey('text')) {\n      result.text = this.unwrap(data.button.text);\n    }\n\n    return result;\n  }\n\n  static #parseButton(data?: YTNodes.Button): PageElement.Button | null {\n    if (!data) {\n      return null;\n    }\n\n    const buttonEndpoint = this.parseEndpoint(data.endpoint);\n    const buttonText = this.unwrap(data.text);\n    if (buttonEndpoint && buttonText) {\n      return {\n        type: 'button',\n        text: buttonText,\n        endpoint: buttonEndpoint\n      };\n    }\n\n    return null;\n  }\n\n  static unwrap(data?: string | YTMisc.Text): string;\n  static unwrap(data?: YTHelpers.SuperParsedResult<YTHelpers.YTNode> | null): YTHelpers.ObservedArray<YTHelpers.YTNode> | YTHelpers.YTNode | null;\n  static unwrap<T>(data?: T): T | null;\n  static unwrap(data?: any) {\n    if (typeof data === 'object' && data?.constructor.name === 'SuperParsedResult') {\n      if (data.is_null) {\n        return null;\n      }\n      else if (data.is_array) {\n        return data.array();\n      }\n      else if (data.is_node) {\n        return data.item();\n      }\n\n      return data;\n    }\n    else if (typeof data === 'string' || data instanceof YTMisc.Text) {\n      const s = (typeof data === 'string') ? data : data.toString();\n      return (s === 'N/A' || s === '') ? null : s;\n    }\n\n    return data;\n  }\n\n  static parseThumbnail(data?: YTMisc.Thumbnail[]): string | null {\n    const url = data?.[0]?.url;\n    if (url?.startsWith('//')) {\n      return `https:${url}`;\n    }\n    return url || null;\n  }\n\n  static parseEndpoint(data?: YTNodes.NavigationEndpoint | null): Endpoint | null {\n    if (!data) {\n      return null;\n    }\n\n    const createPayload = (fields: string[], payloadData?: Record<string, any>) => {\n      const payload: Record<string, any> = {};\n      const src = payloadData || data?.payload;\n      if (src) {\n        for (const field of fields) {\n          if (src[field] !== undefined) {\n            payload[field] = src[field];\n          }\n        }\n      }\n      return payload;\n    };\n\n    switch (data?.metadata?.api_url) {\n      case '/browse':\n      case 'browse':\n        if (data?.payload?.token && data.payload.request === 'CONTINUATION_REQUEST_TYPE_BROWSE') {\n          return {\n            type: EndpointType.BrowseContinuation,\n            payload: {\n              token: data.payload.token\n            }\n          };\n        }\n        return {\n          type: EndpointType.Browse,\n          payload: createPayload([ 'browseId', 'params' ])\n        };\n\n      case '/search':\n      case 'search':\n        if (data?.payload?.token && data.payload.request === 'CONTINUATION_REQUEST_TYPE_SEARCH') {\n          return {\n            type: EndpointType.SearchContinuation,\n            payload: {\n              token: data.payload.token\n            }\n          };\n        }\n        return {\n          type: EndpointType.Search,\n          payload: createPayload([ 'query', 'params' ])\n        };\n\n      case '/player':\n        return {\n          type: EndpointType.Watch,\n          payload: createPayload([ 'videoId', 'playlistId', 'params', 'index' ])\n        };\n\n      case 'next':\n        if (data?.payload?.request === 'CONTINUATION_REQUEST_TYPE_WATCH_NEXT') {\n          return {\n            type: EndpointType.WatchContinuation,\n            payload: {\n              token: data.payload.token\n            }\n          };\n        }\n        break;\n\n      default:\n    }\n\n    if (data?.metadata?.page_type === 'WEB_PAGE_TYPE_SHORTS') {\n      // For now, forget about sequence and treat reelWatchEndpoints\n      // As normal watch endpoints\n      return {\n        type: EndpointType.Watch,\n        payload: createPayload([ 'videoId' ])\n      };\n    }\n\n    return null;\n  }\n}\n"]}